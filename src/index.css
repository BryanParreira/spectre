@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

:root {
  --bg-glass: rgba(18, 18, 23, 0.95);
  --border-glass: rgba(255, 255, 255, 0.12);
  --accent-blue: #007AFF;
  --text-primary: #ffffff;
  --text-secondary: rgba(255, 255, 255, 0.5);
  --input-bg: rgba(0, 0, 0, 0.4);
}

body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: 'Inter', sans-serif; background: transparent !important; }
#root { width: 100%; height: 100%; background: transparent !important; pointer-events: none; }

.invisible-canvas { width: 100%; height: 100%; position: relative; pointer-events: none; }

.unified-widget-container {
  display: flex; flex-direction: column; align-items: center;
  pointer-events: auto;
}

/* 1. PILL */
.widget-pill {
  width: auto; min-width: 240px;
  background: var(--bg-glass);
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
  border: 1px solid var(--border-glass);
  border-radius: 100px;
  padding: 6px 14px;
  display: flex; align-items: center; gap: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  transition: transform 0.2s;
  z-index: 200;
}
.widget-pill:hover { transform: translateY(1px); }

.drag-handle { cursor: grab; display: flex; opacity: 0.5; padding-right: 4px; }
.divider { width: 1px; height: 16px; background: rgba(255,255,255,0.1); margin: 0 4px; }

.pill-btn { background: transparent; border: none; color: #fff; font-size: 13px; font-weight: 500; cursor: pointer; padding: 6px 10px; transition: background 0.2s; }
.pill-btn:hover { background: rgba(255,255,255,0.1); border-radius: 20px; }
.pill-btn.icon-only { padding: 6px; border-radius: 50%; }
.pill-btn.icon-only:hover { background: rgba(255,255,255,0.15); }
.stop-square { width: 10px; height: 10px; background: #fff; border-radius: 2px; }

/* 2. CHAT WINDOW */
.chat-window {
  margin-top: 12px;
  width: 420px; height: 500px;
  background: var(--bg-glass);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border: 1px solid var(--border-glass);
  border-radius: 24px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  display: flex; flex-direction: column; overflow: hidden;
  animation: popIn 0.2s ease-out;
  z-index: 100;
}
@keyframes popIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

.chat-header { padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.03); cursor: grab; }
.header-action { background: none; border: none; color: var(--text-secondary); cursor: pointer; }
.status-live { color: #ef4444; font-size: 11px; font-weight: 600; text-transform: uppercase; }
.status-idle { color: var(--text-secondary); font-size: 11px; font-weight: 600; }

.messages-area { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 16px; }
.msg-row { display: flex; flex-direction: column; gap: 4px; }
.msg-row.user { align-items: flex-end; }
.msg-row.ai { align-items: flex-start; }
.msg-bubble { font-size: 14px; line-height: 1.5; color: #fff; max-width: 90%; }
.user .msg-bubble { background: var(--accent-blue); padding: 10px 16px; border-radius: 16px 16px 4px 16px; }
.ai .msg-bubble { background: rgba(255,255,255,0.08); padding: 10px 16px; border-radius: 16px 16px 16px 4px; }

/* THINKING INDICATOR */
.thinking-bubble { display: flex; align-items: center; padding: 12px 16px !important; color: #aaa !important; }
.thinking-dot {
  width: 6px; height: 6px; background: #fff; border-radius: 50%; margin-right: 4px;
  animation: pulse 1.4s infinite ease-in-out both;
}
.thinking-dot:nth-child(1) { animation-delay: -0.32s; }
.thinking-dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes pulse { 0%, 80%, 100% { transform: scale(0); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }

.input-box { margin: 16px; background: var(--input-bg); border: 1px solid var(--border-glass); border-radius: 16px; padding: 8px; display: flex; gap: 10px; }
.input-box input { background: transparent; border: none; outline: none; color: #fff; padding: 8px; font-size: 14px; flex: 1; }
.send-btn { background: var(--accent-blue); border: none; color: #fff; width: 36px; height: 36px; border-radius: 12px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

/* IMPROVED SETTINGS */
.settings-panel { padding: 20px; display: flex; flex-direction: column; gap: 20px; color: #eee; font-size: 13px; height: 100%; overflow-y: auto; }
.setting-header { font-weight: 600; font-size: 16px; color: #fff; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-glass); padding-bottom: 10px; }
.close-settings { background: none; border: none; color: #aaa; cursor: pointer; }
.setting-section { display: flex; flex-direction: column; gap: 10px; }
.section-title { font-size: 11px; font-weight: 700; color: var(--accent-blue); text-transform: uppercase; display: flex; align-items: center; gap: 6px; margin-bottom: 4px; }
.setting-group { display: flex; flex-direction: column; gap: 6px; }
.setting-group label { color: var(--text-secondary); font-size: 11px; }
.setting-group select, .setting-group input, .system-prompt-area { 
  background: rgba(0,0,0,0.3); border: 1px solid var(--border-glass); padding: 10px; border-radius: 8px; color: white; outline: none; font-family: inherit; font-size: 13px;
}
.system-prompt-area { height: 80px; resize: none; }
.btn-save { background: var(--accent-blue); border: none; padding: 12px; border-radius: 10px; color: white; font-weight: 600; cursor: pointer; margin-top: auto; }
.btn-save:hover { opacity: 0.9; }

.attachment-preview { margin: 0 16px; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 8px; display: flex; align-items: center; gap: 10px; border: 1px solid var(--border-glass); }
.thumb { width: 40px; height: 26px; object-fit: cover; border-radius: 4px; background: #000; }
.attachment-preview button { background: none; border: none; color: #888; cursor: pointer; }

::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }